[2025-03-19 22:00:40,782] INFO [bluesky-AI|task-0] Polling Bluesky for ArtificialIntelligence for posts using offset 2025-03-19T20:49:11.150Z (uk.co.dalelane.kafkaconnect.bluesky.api.BlueskyClient:208)
[2025-03-19 22:00:41,262] INFO [bluesky-AI|task-0] Polling Bluesky for ArtificialIntelligence for posts using offset 2025-03-19T21:00:18.221Z (uk.co.dalelane.kafkaconnect.bluesky.api.BlueskyClient:208)
[2025-03-19 22:00:45,150] INFO [bluesky-AI|task-0|offsets] WorkerSourceTask{id=bluesky-AI-0} Committing offsets for 1 acknowledged messages (org.apache.kafka.connect.runtime.WorkerSourceTask:235)
[2025-03-19 22:01:40,782] INFO [bluesky-AI|task-0] Polling Bluesky for ArtificialIntelligence for posts using offset 2025-03-19T21:00:18.221Z (uk.co.dalelane.kafkaconnect.bluesky.api.BlueskyClient:208)
[2025-03-19 22:02:40,781] INFO [bluesky-AI|task-0] Polling Bluesky for ArtificialIntelligence for posts using offset 2025-03-19T21:00:18.221Z (uk.co.dalelane.kafkaconnect.bluesky.api.BlueskyClient:208)
[2025-03-19 22:02:41,427] INFO [bluesky-AI|task-0] Polling Bluesky for ArtificialIntelligence for posts using offset 2025-03-19T21:02:00.854Z (uk.co.dalelane.kafkaconnect.bluesky.api.BlueskyClient:208)
[2025-03-19 22:02:45,158] INFO [bluesky-AI|task-0|offsets] WorkerSourceTask{id=bluesky-AI-0} Committing offsets for 1 acknowledged messages (org.apache.kafka.connect.runtime.WorkerSourceTask:235)
[2025-03-19 22:03:40,782] INFO [bluesky-AI|task-0] Polling Bluesky for ArtificialIntelligence for posts using offset 2025-03-19T21:02:00.854Z (uk.co.dalelane.kafkaconnect.bluesky.api.BlueskyClient:208)
[2025-03-19 22:04:25,171] INFO [AdminClient clientId=connect-cluster-shared-admin] Node 0 disconnected. (org.apache.kafka.clients.NetworkClient:1017)
[2025-03-19 22:04:40,782] INFO [bluesky-AI|task-0] Polling Bluesky for ArtificialIntelligence for posts using offset 2025-03-19T21:02:00.854Z (uk.co.dalelane.kafkaconnect.bluesky.api.BlueskyClient:208)
[2025-03-19 22:05:40,782] INFO [bluesky-AI|task-0] Polling Bluesky for ArtificialIntelligence for posts using offset 2025-03-19T21:02:00.854Z (uk.co.dalelane.kafkaconnect.bluesky.api.BlueskyClient:208)
[2025-03-19 22:06:40,782] INFO [bluesky-AI|task-0] Polling Bluesky for ArtificialIntelligence for posts using offset 2025-03-19T21:02:00.854Z (uk.co.dalelane.kafkaconnect.bluesky.api.BlueskyClient:208)
[2025-03-19 22:07:40,782] INFO [bluesky-AI|task-0] Polling Bluesky for ArtificialIntelligence for posts using offset 2025-03-19T21:02:00.854Z (uk.co.dalelane.kafkaconnect.bluesky.api.BlueskyClient:208)
[2025-03-19 22:08:40,782] INFO [bluesky-AI|task-0] Polling Bluesky for ArtificialIntelligence for posts using offset 2025-03-19T21:02:00.854Z (uk.co.dalelane.kafkaconnect.bluesky.api.BlueskyClient:208)
[2025-03-19 22:09:25,355] INFO [AdminClient clientId=connect-cluster-shared-admin] Node 0 disconnected. (org.apache.kafka.clients.NetworkClient:1017)
[2025-03-19 22:09:40,782] INFO [bluesky-AI|task-0] Polling Bluesky for ArtificialIntelligence for posts using offset 2025-03-19T21:02:00.854Z (uk.co.dalelane.kafkaconnect.bluesky.api.BlueskyClient:208)
[2025-03-19 22:10:40,783] INFO [bluesky-AI|task-0] Polling Bluesky for ArtificialIntelligence for posts using offset 2025-03-19T21:02:00.854Z (uk.co.dalelane.kafkaconnect.bluesky.api.BlueskyClient:208)
[2025-03-19 22:11:20,977] INFO [Worker clientId=connect-127.0.1.1:8083, groupId=connect-cluster] Session key updated (org.apache.kafka.connect.runtime.distributed.DistributedHerder:2483)
[2025-03-19 22:11:40,783] INFO [bluesky-AI|task-0] Polling Bluesky for ArtificialIntelligence for posts using offset 2025-03-19T21:02:00.854Z (uk.co.dalelane.kafkaconnect.bluesky.api.BlueskyClient:208)
[2025-03-19 22:12:40,783] INFO [bluesky-AI|task-0] Polling Bluesky for ArtificialIntelligence for posts using offset 2025-03-19T21:02:00.854Z (uk.co.dalelane.kafkaconnect.bluesky.api.BlueskyClient:208)
[2025-03-19 22:13:40,784] INFO [bluesky-AI|task-0] Polling Bluesky for ArtificialIntelligence for posts using offset 2025-03-19T21:02:00.854Z (uk.co.dalelane.kafkaconnect.bluesky.api.BlueskyClient:208)
[2025-03-19 22:14:40,783] INFO [bluesky-AI|task-0] Polling Bluesky for ArtificialIntelligence for posts using offset 2025-03-19T21:02:00.854Z (uk.co.dalelane.kafkaconnect.bluesky.api.BlueskyClient:208)
[2025-03-19 22:15:40,783] INFO [bluesky-AI|task-0] Polling Bluesky for ArtificialIntelligence for posts using offset 2025-03-19T21:02:00.854Z (uk.co.dalelane.kafkaconnect.bluesky.api.BlueskyClient:208)
[2025-03-19 22:16:40,783] INFO [bluesky-AI|task-0] Polling Bluesky for ArtificialIntelligence for posts using offset 2025-03-19T21:02:00.854Z (uk.co.dalelane.kafkaconnect.bluesky.api.BlueskyClient:208)
[2025-03-19 22:16:41,171] ERROR [bluesky-AI|task-0] Error while submitting search to Bluesky (uk.co.dalelane.kafkaconnect.bluesky.api.BlueskyClient:256)
org.json.JSONException: JSONObject["posts"] not found.
	at org.json.JSONObject.get(JSONObject.java:596)
	at org.json.JSONObject.getJSONArray(JSONObject.java:789)
	at uk.co.dalelane.kafkaconnect.bluesky.api.BlueskyClient.searchPage(BlueskyClient.java:245)
	at uk.co.dalelane.kafkaconnect.bluesky.api.BlueskyClient.search(BlueskyClient.java:201)
	at uk.co.dalelane.kafkaconnect.bluesky.source.BlueskyDataFetcher$1.run(BlueskyDataFetcher.java:67)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:566)
	at java.base/java.util.TimerThread.run(Timer.java:516)
[2025-03-19 22:17:40,783] INFO [bluesky-AI|task-0] Polling Bluesky for ArtificialIntelligence for posts using offset 2025-03-19T21:02:00.854Z (uk.co.dalelane.kafkaconnect.bluesky.api.BlueskyClient:208)
[2025-03-19 22:18:40,783] INFO [bluesky-AI|task-0] Polling Bluesky for ArtificialIntelligence for posts using offset 2025-03-19T21:02:00.854Z (uk.co.dalelane.kafkaconnect.bluesky.api.BlueskyClient:208)
[2025-03-19 22:18:41,400] INFO [bluesky-AI|task-0] Polling Bluesky for ArtificialIntelligence for posts using offset 2025-03-19T21:17:34.819Z (uk.co.dalelane.kafkaconnect.bluesky.api.BlueskyClient:208)
[2025-03-19 22:18:45,181] INFO [bluesky-AI|task-0|offsets] WorkerSourceTask{id=bluesky-AI-0} Committing offsets for 1 acknowledged messages (org.apache.kafka.connect.runtime.WorkerSourceTask:235)
[2025-03-19 22:19:25,656] INFO [AdminClient clientId=connect-cluster-shared-admin] Node 0 disconnected. (org.apache.kafka.clients.NetworkClient:1017)
[2025-03-19 22:19:40,783] INFO [bluesky-AI|task-0] Polling Bluesky for ArtificialIntelligence for posts using offset 2025-03-19T21:17:34.819Z (uk.co.dalelane.kafkaconnect.bluesky.api.BlueskyClient:208)
[2025-03-19 22:20:40,783] INFO [bluesky-AI|task-0] Polling Bluesky for ArtificialIntelligence for posts using offset 2025-03-19T21:17:34.819Z (uk.co.dalelane.kafkaconnect.bluesky.api.BlueskyClient:208)
[2025-03-19 22:21:36,189] ERROR [bluesky-AI|task-0] Failed to refresh session - http 400 (uk.co.dalelane.kafkaconnect.bluesky.api.BlueskyClient:162)
[2025-03-19 22:21:40,784] ERROR [bluesky-AI|task-0] WorkerSourceTask{id=bluesky-AI-0} Task threw an uncaught and unrecoverable exception. Task is being killed and will not recover until manually restarted (org.apache.kafka.connect.runtime.WorkerTask:233)
org.apache.kafka.connect.errors.ConnectException: uk.co.dalelane.kafkaconnect.bluesky.api.BlueskyException: Failed to refresh Bluesky session - response code 400
	at uk.co.dalelane.kafkaconnect.bluesky.source.BlueskyDataFetcher.getStatuses(BlueskyDataFetcher.java:105)
	at uk.co.dalelane.kafkaconnect.bluesky.source.BlueskySourceTask.poll(BlueskySourceTask.java:66)
	at org.apache.kafka.connect.runtime.AbstractWorkerSourceTask.poll(AbstractWorkerSourceTask.java:465)
	at org.apache.kafka.connect.runtime.AbstractWorkerSourceTask.execute(AbstractWorkerSourceTask.java:353)
	at org.apache.kafka.connect.runtime.WorkerTask.doRun(WorkerTask.java:225)
	at org.apache.kafka.connect.runtime.WorkerTask.run(WorkerTask.java:280)
	at org.apache.kafka.connect.runtime.AbstractWorkerSourceTask.run(AbstractWorkerSourceTask.java:78)
	at org.apache.kafka.connect.runtime.isolation.Plugins.lambda$withClassLoader$1(Plugins.java:237)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: uk.co.dalelane.kafkaconnect.bluesky.api.BlueskyException: Failed to refresh Bluesky session - response code 400
	at uk.co.dalelane.kafkaconnect.bluesky.api.BlueskyClient.refreshLogin(BlueskyClient.java:163)
	at uk.co.dalelane.kafkaconnect.bluesky.api.BlueskyClient$1.run(BlueskyClient.java:83)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:566)
	at java.base/java.util.TimerThread.run(Timer.java:516)
[2025-03-19 22:21:40,785] INFO [bluesky-AI|task-0] Stopping task (uk.co.dalelane.kafkaconnect.bluesky.source.BlueskySourceTask:53)
[2025-03-19 22:21:40,786] INFO [bluesky-AI|task-0] [Producer clientId=connector-producer-bluesky-AI-0] Closing the Kafka producer with timeoutMillis = 30000 ms. (org.apache.kafka.clients.producer.KafkaProducer:1373)
[2025-03-19 22:21:40,790] INFO [bluesky-AI|task-0] Metrics scheduler closed (org.apache.kafka.common.metrics.Metrics:684)
[2025-03-19 22:21:40,790] INFO [bluesky-AI|task-0] Closing reporter org.apache.kafka.common.metrics.JmxReporter (org.apache.kafka.common.metrics.Metrics:688)
[2025-03-19 22:21:40,790] INFO [bluesky-AI|task-0] Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter (org.apache.kafka.common.metrics.Metrics:688)
[2025-03-19 22:21:40,790] INFO [bluesky-AI|task-0] Metrics reporters closed (org.apache.kafka.common.metrics.Metrics:694)
[2025-03-19 22:21:40,791] INFO [bluesky-AI|task-0] App info kafka.producer for connector-producer-bluesky-AI-0 unregistered (org.apache.kafka.common.utils.AppInfoParser:88)
[2025-03-19 22:24:25,838] INFO [AdminClient clientId=connect-cluster-shared-admin] Node 0 disconnected. (org.apache.kafka.clients.NetworkClient:1017)
[2025-03-19 22:29:26,013] INFO [AdminClient clientId=connect-cluster-shared-admin] Node 0 disconnected. (org.apache.kafka.clients.NetworkClient:1017)
[2025-03-19 22:34:26,210] INFO [AdminClient clientId=connect-cluster-shared-admin] Node 0 disconnected. (org.apache.kafka.clients.NetworkClient:1017)
[2025-03-19 22:39:26,412] INFO [AdminClient clientId=connect-cluster-shared-admin] Node 0 disconnected. (org.apache.kafka.clients.NetworkClient:1017)
[2025-03-19 22:44:26,609] INFO [AdminClient clientId=connect-cluster-shared-admin] Node 0 disconnected. (org.apache.kafka.clients.NetworkClient:1017)
[2025-03-19 22:49:26,807] INFO [AdminClient clientId=connect-cluster-shared-admin] Node 0 disconnected. (org.apache.kafka.clients.NetworkClient:1017)
[2025-03-19 22:54:27,009] INFO [AdminClient clientId=connect-cluster-shared-admin] Node 0 disconnected. (org.apache.kafka.clients.NetworkClient:1017)
[2025-03-19 22:59:27,200] INFO [AdminClient clientId=connect-cluster-shared-admin] Node 0 disconnected. (org.apache.kafka.clients.NetworkClient:1017)
